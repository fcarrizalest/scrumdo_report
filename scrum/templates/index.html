{% extends "base.html" %}

{% block content %}


<h1>{{end_date}}</h1>

<table>


<tr>
	<th> Nombre  </th>
	<th> #Historias </th>
	<th> #Puntos </th>

	<th> #HistoriasB </th>
	<th> #Bugs Puntos </th>

</tr>




{% for iteration in rows%}

	
		<tr>	

		<td> {{ iteration.PName}} - {{iteration.name}}</td>
		<td style="text-align:right"> {{iteration.story_count}} </td>
		<td style="text-align:right" >  {{iteration.SPoints}}  </td>

		<td style="text-align:right" >   {{iteration.SB}}  </td>
		<td style="text-align:right" >   {{iteration.SBPoints}}  </td>

	</tr>

{% endfor %}
	<tr>
		<td></td>
		<td style="text-align:right"> {{ rows|sum(  attribute='story_count' )}} </td>
		<td style="text-align:right" > {{ rows|sum(  attribute='SPoints' )}} </td>

		<td style="text-align:right" >  {{ rows|sum(  attribute='SB' )}}  </td>
		<td style="text-align:right" >  {{ rows|sum(  attribute='SBPoints' )}}  </td>
	</tr>

</table>


{% for iteration in iteration_list%}
	

	{% if iteration.stories|sum(attribute='points') > 0 %}


	<h1>{{iteration.project.name}} - {{iteration.name}}  ( {{ iteration.stories|sum(attribute='points') }} ) </h1>
	<br>
	<table>

		<tr>
				<th>  Usuario(s) </th>
				<th>  #Historia </th>
				<th>  Historia</th>
				<th>  Puntos </th>
				<th>  Status</th>
				<th>  Tipo</th>


		</tr>
	{% for story in iteration.stories%}
	<tr>	

			<td> 


				{{story.users|map(attribute='username')|join(', ') }}
				

			</td>

			<td> #{{story.number}}</td>
			<td> {{story.summary|truncate(50)}} </td>
			<td style="text-align:right"> {{story.points}} </td>
			<td style="text-align:center" > {{story.cell.label}} </td>
			<td style="text-align:center"> 


				{{story.labels|map(attribute='name')|join(', ') }}
				
				

			</td>

	</tr>

	{% endfor %} 

	

	</table>

	{% endif %}


{% endfor %}



{% endblock %}